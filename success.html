<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login Successful - Security Details</title>
    <link rel="stylesheet" href="style.css" />
    <style>
      body {
        margin: 0;
        padding: 0;
        min-height: 100vh;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }
      .app {
        width: 100%;
        max-width: none;
        padding: 2rem;
        margin: 0;
      }
      .card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        padding: 2rem;
        max-width: 1200px;
        margin: 0 auto;
      }
      .section { 
        margin-top: 2rem;
        padding: 1.5rem;
        border-radius: 15px;
        background: #ffffff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s;
      }
      .section:hover {
        transform: translateY(-2px);
      }
      .code { 
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; 
        background: #f8fafc; 
        border: 1px solid #e5e7eb; 
        border-radius: 12px; 
        padding: 12px; 
        white-space: pre-wrap;
        position: relative;
      }
      .code::before {
        content: 'âœ¨';
        position: absolute;
        top: -10px;
        right: -10px;
        background: #764ba2;
        color: white;
        padding: 5px;
        border-radius: 50%;
        font-size: 12px;
      }
      .kv { 
        display: grid; 
        gap: 12px; 
        margin-top: 16px; 
      }
      .kv div { 
        background: #f9fafb; 
        border: 1px dashed #764ba2; 
        padding: 15px; 
        border-radius: 10px;
        transition: all 0.3s ease;
      }
      .kv div:hover {
        background: #f0f4ff;
        border-color: #667eea;
      }
      .row { 
        display: flex; 
        gap: 12px; 
        flex-wrap: wrap;
        justify-content: center;
      }
      .muted { 
        color: #6b7280; 
        font-size: 0.95rem;
        line-height: 1.6;
      }
      .app-title {
        text-align: center;
        color: #1a1a1a;
        font-size: 2.5rem;
        margin-bottom: 1.5rem;
        position: relative;
      }
      .app-title::after {
        content: '';
        display: block;
        width: 60px;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2);
        margin: 10px auto 0;
        border-radius: 2px;
      }
      .btn {
        padding: 12px 24px;
        border-radius: 8px;
        font-weight: 600;
        transition: all 0.3s ease;
      }
      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      .hint {
        text-align: center;
        margin-top: 2rem;
        padding: 1rem;
        background: #fffbeb;
        border-radius: 10px;
        border-left: 4px solid #f59e0b;
      }
    </style>
  </head>
  <body>
    <main class="app">
      <section class="card">
        <h1 class="app-title">Welcome</h1>
        <p id="welcome" class="muted">Loading...</p>

        <div class="row" style="margin:10px 0 0 0;">
          <button id="btn-logout" class="btn ghost" type="button">Logout</button>
          <a href="index.html" class="btn primary" style="text-decoration:none; display:inline-block;">Back to App</a>
        </div>

        <div class="section">
          <h3>What is SHA-256?</h3>
          <p class="muted">
            SHA-256 is a one-way cryptographic hash function that turns any input into a fixed 256-bit (64-hex) digest. It cannot be reversed to recover the original password.
          </p>
          <div class="kv">
            <div><strong>Your username:</strong> <span id="kv-username"></span></div>
            <div><strong>Stored password hash (SHA-256):</strong> <span id="kv-hash" style="word-break:break-all;"></span></div>
          </div>
        </div>

        <div class="section">
          <h3>How we implemented hashing (JavaScript)</h3>
          <p class="muted">We use the Web Crypto API in the browser to compute SHA-256. Only the hash is stored in <code>localStorage</code>.</p>
          <pre class="code"><code>// Convert text to SHA-256 hex using Web Crypto
async function sha256(text) {
  const enc = new TextEncoder();
  const data = enc.encode(text);
  const digest = await crypto.subtle.digest('SHA-256', data);
  return Array.from(new Uint8Array(digest))
    .map(b => b.toString(16).padStart(2, '0'))
    .join('');
}

// On registration:
// 1) Verify captcha
// 2) Hash password
// 3) Store { username, hashedPassword } in localStorage

// On login:
// 1) Verify captcha
// 2) Hash entered password
// 3) Compare hashes</code></pre>
        </div>

        <div class="section">
          <h3>Captcha</h3>
          <p class="muted">
            We generate a random 6-character alphanumeric string (excluding confusing characters) for each attempt. You must type it correctly to proceed.
          </p>
          <pre class="code"><code>// Example captcha generator
function generateCaptcha() {
  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
  let out = '';
  for (let i = 0; i < 6; i++) {
    out += chars[Math.floor(Math.random() * chars.length)];
  }
  return out;
}</code></pre>
        </div>

        <p class="hint">Note: This is a demo. Real apps also use server-side checks, salts, and rate limiting.</p>
      </section>
    </main>

    <script>
      // Simple session gate: require authUser set by index login
      const username = localStorage.getItem('authUser');
      if (!username) {
        window.location.replace('index.html');
      }

      // Load stored hash from localStorage users map
      const usersRaw = localStorage.getItem('users');
      let storedHash = '';
      try {
        const users = usersRaw ? JSON.parse(usersRaw) : {};
        storedHash = users[username]?.hashedPassword || '';
      } catch {}

      // Populate UI
      document.getElementById('welcome').textContent = `You are logged in as \u201c${username}\u201d.`;
      document.getElementById('kv-username').textContent = username;
      document.getElementById('kv-hash').textContent = storedHash || '(missing)';

      // Logout
      document.getElementById('btn-logout').addEventListener('click', () => {
        localStorage.removeItem('authUser');
        window.location.href = 'index.html';
      });
    </script>
  </body>
  </html>


